\usepackage[
    fontset=none,%设置中文支持，并自定义字体
    zihao=5,%默认字号为五号
    heading=true,%允许后续自定义标题样式
    scheme=chinese,%自动将文档样式中文化，例如图标标题
    punct=quanjiao,%全角式标点符号
    space=auto,%中文后接换行不会添加空格，但是英文会添加空格，需要用%手动取消
    linespread=1.3,%行距倍数是1.3
    autoindent=true,%自动缩进两个中文宽度
    ]{ctex}
\ctexset{
    % tday=small,%小写样式的日期
    contentsname={目录},
    listfigurename={插图},
    listtablename={表格},
    figurename={图},
    tablename={表},
    abstractname={摘要},
    indexname={索引},
    appendixname={附录},
    bibname={参考文献},
    proofname={证明},
    % refname={参考文献},%只适用于beamer
    % algorithmname={算法},
    % continuation={（续）},%beamer续页的标识
    section={
        format+ = \Large\heiti\raggedright,
        name = {,\num\textbf{.}\hspace{1ex}},
        number={\num\thesection},
        nameformat={},
        numberformat={},
        aftername={},
        titleformat={},
        aftertitle={},
        runin=false,%对section级以下有用，标题是否和正文在同一段上
        beforeskip={3.5ex plus 1ex minus .2ex},%标题前垂直间距
        afterskip={2.3ex plus .2ex}%标题后垂直间距
    },
    subsection={
        format+ = \large\heiti\raggedright,
        name = {,\num\textbf{.}\hspace{1ex}},
        number={\num\thesubsection},
        nameformat={},
        numberformat={},
        aftername={},
        titleformat={},
        aftertitle={},
        runin=false,%对section级以下有用，标题是否和正文在同一段上
        beforeskip={3.5ex plus 1ex minus .2ex},%标题前垂直间距
        afterskip={2.3ex plus .2ex}%标题后垂直间距
    },
    subsubsection={
        format+ = \normalsize\heiti\raggedright,
        name = {,\num\textbf{.}\hspace{1ex}},
        number={\num\thesubsubsection},
        nameformat={},
        numberformat={},
        aftername={},
        titleformat={},
        aftertitle={},
        runin=false,%对section级以下有用，标题是否和正文在同一段上
        beforeskip={3.5ex plus 1ex minus .2ex},%标题前垂直间距
        afterskip={2.3ex plus .2ex}%标题后垂直间距
    },
    }

% 中文默认字体： 思源宋体，粗体为思源宋体半粗体，斜体为方正楷体_GBK
\setCJKmainfont{Source Han Serif SC}[BoldFont={Source Han Serif SC Heavy}, ItalicFont=FZKai-Z03S]
% 中文无衬线字体：思源黑体，粗体为思源黑体粗体
\setCJKsansfont{Source Han Sans CN}[BoldFont={Source Han Sans CN Heavy}]
% 中文等宽字体：微软雅黑light
\setCJKmonofont{Microsoft YaHei}[ItalicFont={Microsoft YaHei Light}]

\newCJKfontfamily\songti{Source Han Serif SC}[BoldFont={Source Han Serif SC Heavy}]
\newCJKfontfamily\xbsong{Source Han Serif SC SemiBold} % 小标宋
\newCJKfontfamily\dbsong{Source Han Serif SC Bold} % 大标宋
\newCJKfontfamily\cusong{Source Han Serif SC Heavy} % 粗宋
\newCJKfontfamily\heiti{Source Han Sans CN}[BoldFont={Source Han Sans CN Heavy}]
\newCJKfontfamily\dahei{Source Han Sans CN Medium} % 大黑
\newCJKfontfamily\cuhei{Source Han Sans CN Heavy} % 粗黑
\newCJKfontfamily\fangsong{FZFangSong-Z02S}
\newCJKfontfamily\kaiti{FZKai-Z03S}[ItalicFont={Microsoft YaHei Light}]%这个斜体只是用于lstlisting环境中的中文注释
% \newCJKfontfamily\kaiti{FZKai-Z03S}[ItalicFont={FZZJ-LZXTFSJW}]%这个斜体只是用于lstlisting环境中的中文注释
\setsansfont{Arial}
\setmonofont{Consolas}%设置西文等宽字体
\newfontfamily\code{Consolas}
\newfontfamily\num{Arial}

\usepackage{geometry}%设置整体页面布局
\geometry{a4paper}
\geometry{left=2cm,right=2cm,top=2.54cm,bottom=2.54cm}%word常规页边距
% \geometry{left=1.27cm,right=1.27cm,top=1.27cm,bottom=1.27cm}%word窄页边距
\setlength{\headheight}{13pt}%避免warning


\usepackage{fancyhdr}%必须在geometry包之后使用
\fancyhf{}
\lhead{{\dahei 实验报告}}%可以使用thepage,CTEXthechapter,CTEXthesection
\rhead{\textbf{\num- \thepage{} -}}
\renewcommand\headrulewidth{1.5pt}%设置眉头宽度
\pagestyle{fancy}

\usepackage[ruled,algosection,lined,longend,fillcomment,linesnumbered,resetcount,titlenotnumbered]{algorithm2e}
%参数解释：带框，按section编码，有竖线，end前带if等关键词，注释占满整行，代码部分编号（不包括输入输出、注释），每个代码块重新编号，可以调用TitleOfAlgo来打印算法标题但不作为单独的算法编码
%附带algorithm,function,procedure环境,其中function,procedure环境下，设置caption时，必须带有()，
%()之前的字符会被视为宏，可以在接下来的部分用\名字()来调用，所以推荐辅助函数用function，其中的某些展开部分用procedure，描述算法整体使用algorithm
\DontPrintSemicolon
\SetStartEndCondition{ \textbf{(}}{\textbf{)} }{\textbf{)} }
\SetAlCapSkip{2ex}
\SetSideCommentRight
\SetFillComment
\newcommand{\forcond}{$i=0$ \KwTo $n$}
\SetKw{macro}{text}%自定义关键词
\SetKwFunction{funcmacro}{text}%自定义函数名，实际上function环境是在定义宏的同时说明了其内容
\SetKwProg{procedmacro}{text}{begin text}{end text}%自定义步骤，和function类似，但是后面两个参数可以设置开始和结尾的标志，和if等环境一样
\SetKwData{datamacro}{text}%可以用于突出特殊的变量，例如数据结构
\SetKwFunction{FRecurs}{FnRecursive}
\SetKwProg{Fn}{Function}{begin}{end}

\usepackage[dvipsnames,svgnames]{xcolor}%颜色支持
\definecolor{vscode_backgroundcolor}{rgb}{0,0.14,0.32}
\definecolor{vscode_localvariablecolor}{rgb}{0.94,0.62,0.64}
\definecolor{vscode_keywordcolor}{rgb}{0.92,0.73,1}
\definecolor{vscode_commentcolor}{rgb}{0.55,0.64,0.79}
\definecolor{vscode_stringcolor}{rgb}{0.05,0.95,0.86}
\definecolor{vscode_semicolomncolor}{rgb}{1,1,1}
\definecolor{vscode_headerfilecolor}{rgb}{0.82,0.95,0.65}
\definecolor{vscode_linenumbercolor}{rgb}{0.52,0.52,0.52}
\definecolor{vscode_numbercolor}{rgb}{1,0.77.0.56}
\definecolor{vscode_operatorcolor}{rgb}{0.6,1,1}
\definecolor{vscode_functioncolor}{rgb}{0.22,0.65,0.96}
\definecolor{vscode_rulecolor}{rgb}{0.17,0.46,0.65}

\usepackage{listings}%高亮代码块支持
\lstloadlanguages{C,C++,Python}
\lstdefinelanguage{MyC}{
    sensitive=true,
   morestring=[b]",
    morekeywords={
        alignas,continute,friend,register,true,alignof,decltype,goto,
    reinterpret_cast,try,asm,defult,if,return,typedef,auto,delete,inline,short,
    typeid,bool,do,int,signed,typename,break,double,long,union,case,
    dynamic_cast,mutable,static,unsigned,catch,else,namespace,static_assert,using,
    char,enum,new,static_cast,virtual,char16_t,char32_t,explict,noexcept,struct,
    void,export,nullptr,switch,volatile,class,extern,operator,template,wchar_t,
    const,false,private,this,while,constexpr,float,protected,thread_local,
    const_cast,for,public,throw,std,
    },%keyword要两侧均为空格才能识别出来
}
\lstdefinestyle{MyC}{
    language=MyC,
    extendedchars=false,
    numbers=left,
    firstnumber=auto,
    frame=leftline,
    backgroundcolor=\color{vscode_backgroundcolor},
    framerule=0.5ex,
    columns=fixed,
    language=C++,
    basicstyle=\ttfamily\color{vscode_localvariablecolor},
    % commentstyle=\color{vscode_commentcolor},
    keywordstyle=\color{vscode_keywordcolor},
    stringstyle=\color{vscode_stringcolor},
    morecomment=[l][\color{vscode_commentcolor}]{//},
    morecomment=[s][\color{vscode_commentcolor}]{/*}{*/},
    % morecomment=[s][\color{vscode_headerfilecolor}]{<}{>},
    numberstyle=\code\color{vscode_linenumbercolor},
    alsoletter={
        ;
        % ;0123456789
        % 0,1,2,3,4,5,6,7,8,9
    },%把;设置为可以识别的letter，也可以使用otherkeywords，但是无法将其和其他keywords区分开来
    emph={;},emphstyle=\color{vscode_semicolomncolor},
    % alsoletter={!,\%,&,*,-,+,=,/,<,>},
    % emph={[3]sizeof,!,\%,&,*,-,+,=,/,<,>},emphstyle={[3]\color{vscode_operatorcolor}},
    emph={
        [2]
        main,%在此处添加函数名
        getnum,
        printf
        },emphstyle={[2]\color{vscode_functioncolor}},%此处添加函数名
    % emph={[3]0,1,2,3,4,5,6,7,8,9},emphstyle={[3]\color{yellow}},
    tabsize=4,
    rulecolor=\color{vscode_rulecolor},
    breaklines=true,
}
\lstset{
    style=MyC,
}
%参数含义为：代码语言为C，使用其他包来处理拓展字符，左侧显示行数，行数按照listing的name来延拓，轮廓为有阴影，左上角为直角，其余为圆角
%

\usepackage[strict]{changepage}
\usepackage{framed}%色块支持
\definecolor{formalshade}{rgb}{0.95,0.95,1} % 文本框颜色
% ------------------******-------------------
% 注意行末需要把空格注释掉，不然画出来的方框会有空白竖线
\newenvironment{formal}{%
\def\FrameCommand{%
\hspace{1pt}%
{\color{DarkBlue}\vrule width 2pt}%
{\color{formalshade}\vrule width 4pt}%
\colorbox{formalshade}%
}%
\MakeFramed{\advance\hsize-\width\FrameRestore}%
\noindent\hspace{-4.55pt}% disable indenting first paragraph
\begin{adjustwidth}{}{7pt}%
\vspace{2pt}\vspace{2pt}%
}
{%
\vspace{2pt}\end{adjustwidth}\endMakeFramed%
}

% 自定义标题格式
\makeatletter
\renewcommand{\maketitle}{
  \begin{center}
    \thispagestyle{fancy}
    {\quad}\\
    \vspace{0.1\textheight}
    {\huge\sffamily\bfseries\@title}\\ % 标题字体大小、粗体、颜色
    \vspace{2em} % 标题与作者名之间的垂直空间
    {\large\sffamily\@author} \\
  \end{center}
}
\makeatother